<!-- Dashboard espec√≠fico para Gestor (id_role = 2) -->
<div class="gestor-dashboard">
    
    <!-- PE: Minha Equipe -->
    <div class="dashboard-section team-section">
        <div class="section-header">
            <h2 class="section-title">
                <span class="section-icon">üë•</span>
                Minha Equipe
            </h2>
            <div class="section-actions">
                <button id="add-ptd-btn" class="action-btn primary" title="Adicionar PTD">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                </button>
                <button id="refresh-team" class="refresh-btn" title="Atualizar equipe">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <div id="team-members" class="team-grid">
            <!-- Membros da equipe ser√£o carregados dinamicamente -->
            <div class="team-loading">Carregando equipe...</div>
        </div>
    </div>

    <!-- RKE: Ranking da Equipe -->
    <div class="dashboard-section ranking-section">
        <div class="section-header">
            <h2 class="section-title">
                <span class="section-icon">üèÜ</span>
                Ranking da Equipe
            </h2>
        </div>
        
        <div id="team-ranking" class="ranking-table-container">
            <!-- Ranking ser√° carregado dinamicamente -->
            <div class="ranking-loading">Carregando ranking...</div>
        </div>
    </div>

    <!-- A√ß√µes de Gest√£o -->
    <div class="dashboard-section management-section">
        <div class="section-header">
            <h2 class="section-title">
                <span class="section-icon">‚öôÔ∏è</span>
                Gest√£o
            </h2>
        </div>
        
        <div class="management-actions">
            <!-- ATTR: Atribuir Trilha -->
            <button id="assign-trail-btn" class="management-card assign-trail">
                <div class="card-icon">üéØ</div>
                <div class="card-content">
                    <h3 class="card-title">Atribuir Trilha</h3>
                    <p class="card-description">Atribuir trilhas espec√≠ficas para membros da equipe</p>
                </div>
            </button>
            
            <!-- CPTD: Criar PTD -->
            <button id="create-ptd-btn" class="management-card create-ptd">
                <div class="card-icon">üë§</div>
                <div class="card-content">
                    <h3 class="card-title">Criar PTD</h3>
                    <p class="card-description">Cadastrar novo PTD na plataforma</p>
                </div>
            </button>
        </div>
    </div>

    <!-- PT: Progresso das Trilhas -->
    <div class="dashboard-section progress-section">
        <div class="section-header">
            <h2 class="section-title">
                <span class="section-icon">üìä</span>
                Progresso das Trilhas
            </h2>
            <button id="refresh-progress" class="refresh-btn" title="Atualizar progresso">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                </svg>
            </button>
        </div>
        
        <div id="team-progress" class="progress-grid">
            <!-- Progresso ser√° carregado dinamicamente -->
            <div class="progress-loading">Carregando progresso...</div>
        </div>
    </div>
</div>

<!-- Templates para elementos din√¢micos -->
<template id="team-member-template">
    <div class="team-member-card" data-ptd-id="">
        <div class="member-avatar">
            <img src="" alt="Avatar" class="avatar-img">
        </div>
        <div class="member-info">
            <h4 class="member-name"></h4>
            <span class="member-email"></span>
        </div>
        <div class="member-actions">
            <button class="member-action-btn view-btn" onclick="viewPTDProfile(this.dataset.ptdId)" title="Ver perfil">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
            </button>
            <button class="member-action-btn remove-btn" onclick="removePTDFromTeam(this.dataset.ptdId)" title="Remover da equipe">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
    </div>
</template>

<template id="ranking-table-template">
    <table class="ranking-table">
        <thead>
            <tr>
                <th>Posi√ß√£o</th>
                <th>Nome</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody id="ranking-tbody">
            <!-- Linhas ser√£o inseridas dinamicamente -->
        </tbody>
    </table>
</template>

<template id="ranking-row-template">
    <tr class="ranking-row" data-ptd-id="">
        <td class="position-cell">
            <span class="position-number"></span>
        </td>
        <td class="name-cell">
            <span class="ptd-name"></span>
        </td>
        <td class="score-cell">
            <span class="ptd-score"></span>
        </td>
    </tr>
</template>

<template id="progress-card-template">
    <div class="progress-card" data-ptd-id="">
        <div class="progress-header">
            <h4 class="ptd-name"></h4>
            <span class="progress-summary"></span>
        </div>
        <div class="progress-trails">
            <!-- Trilhas ser√£o inseridas dinamicamente -->
        </div>
    </div>
</template>

<template id="trail-progress-template">
    <div class="trail-progress-item" data-trail-id="">
        <div class="trail-info">
            <span class="trail-name"></span>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <span class="progress-percentage"></span>
        </div>
    </div>
</template>

<!-- Modais -->
<%- include('../components/modals/add-ptd-modal') %>
<%- include('../components/modals/assign-trail-modal') %>
<%- include('../components/modals/create-ptd-modal') %>

<script>
// Fun√ß√µes espec√≠ficas para Gestor
function viewPTDProfile(ptdId) {
    if (ptdId) {
        window.location.href = `/perfil/${ptdId}`;
    }
}

function removePTDFromTeam(ptdId) {
    if (confirm('Deseja realmente remover este PTD da sua equipe?')) {
        window.Dashboard.removePTDFromTeam(ptdId);
    }
}

// Carregar dados espec√≠ficos do Gestor
document.addEventListener('DOMContentLoaded', function() {
    // Carregar membros da equipe
    window.Dashboard.loadTeamMembers();
    
    // Carregar ranking da equipe
    window.Dashboard.loadTeamRanking();
    
    // Carregar progresso da equipe
    window.Dashboard.loadTeamProgress();
    
    // Event listeners para a√ß√µes
    document.getElementById('add-ptd-btn')?.addEventListener('click', function() {
        window.Dashboard.openAddPTDModal();
    });
    
    document.getElementById('assign-trail-btn')?.addEventListener('click', function() {
        window.Dashboard.openAssignTrailModal();
    });
    
    document.getElementById('create-ptd-btn')?.addEventListener('click', function() {
        window.Dashboard.openCreatePTDModal();
    });
    
    // Event listeners para refresh
    document.getElementById('refresh-team')?.addEventListener('click', function() {
        window.Dashboard.loadTeamMembers();
    });
    
    document.getElementById('refresh-progress')?.addEventListener('click', function() {
        window.Dashboard.loadTeamProgress();
    });
});
</script>